这是在2024.5.7开始的快手第一段实习，也是自己人生的第一次实习。



# 204.5.7 环境配置

今天主要就是环境的配置，主要第一次使用了mac系统，还是m3芯片的，感觉很好用，但是配环境的时候是真的很难受。





# 2024.5.8 理解实习业务

今天主要了解自己将要做的业务，了解一下自己部门的业务，还有一些行业经常使用的黑话。部门的主要业务在于对代理商、广告主、直销三者之间的分钱算法规则的落地开发。商业化其实就是打广告，满足那些广告主的要求，把广告投放到快手主站app上，当然其中还涉及如何提高投放质量的问题，还有让广告主使用的crm平台的开发，我自己实习的部门主要就是实现对于分钱规则的算法落地。



# 2024.5.15 pdf文件预览加水印需求整理

本次是根据在实习时候的第一个需求，预览pdf政策文件时需要加上水印，确保政策文件不会被提前泄露。

通过浏览代码，发现这是需要自己增加的一个接口。身为后端人员就自己定义了一个接口的规范，用get方式进行请求，需要传参是一个long型的政策id。根据这个id，首先在下一层的逻辑层（快手的这个项目和一般的mvc层不一样，中间多了一层biz层，要求逻辑在这里进行处理）进行权限的校验；校验完成之后就需要需要首先获取到政策的二进制文件，之后将这个二进制文件的字节数组作为参数传递给加水印工具，会返回一个加入水印之后的二进制字节数组，在进行封装返回给前端进行渲染即可。



# 2024.6.1 kim通知格式调整+增加通知人员

这是在代理商政策完成的第二个需求，在这个需求中需要调用的是kim的远程rpc接口。首先是根据需求规定，更改了模板信息。之后需要找到政策所属销支，找到销支的领导（这个是在crm架构树上的领导），但是对于一些其他的虚线领导我们也需要进行通知，这个时候就需要去邮件组成员中获取虚线领导，但是记得他们看到的代理商政策应该为空。这是由于在crm架构树上没有虚线领导，在底层也没有表来映射这些虚线领导所管理的销支人员，那么根本无法获取虚线领导管理的销支人员，这个时候能够做的就只是通知虚线领导政策开始，但是无法通知具体的代理商名单。这里学到的主要是调用rpc框架



# 2024.6.14 元算系统，本次迭代下模型复制

这是一个新的项目，叫做元算。项目是对于政策模型的解耦项目。一般客政策项目，最终对于奖金计算的时候时需要人力去实现的，并且政策配置玩法的时候需要后端研发人员去支持的。但是为了简化这种计算操作，我们抽象出来的这个项目，主要是将计算的模块和流程抽取出来，这就需要很轻的功底来支持。
做的第一个需求，是针对本次迭代内计算模型的复制功能，这就需要了解每个模型的构成，复制字段并且更该变化的字段。

开发步骤和逻辑：
1. 首先定义了请求的借口，/rest/infra/yuansuan/model/copyModel
2. 在biz层进行权限检验，查询当前迭代是否存在此模型，不存在则报错，存在就需要进行具体的复制操作。
3. 对于模型进行复制，这是一个大的操作，具体的操作应该按照下面的顺序进行复制。
4. 复制流程：
4.1. 生成模型code（modelCode）
4.2. 容器也需要进行复制，直接抽出一个新的方法，可以同时获取原始容器和复制容器的code映射，并且这个方法可以返回新的复制容器对象列表。
4.3. 对于模型进行复制。
4.4. 对于边进行复制，之后将容器和算子的映射关系新插入表中就可以了。

# 2024.6.14 元算系统，线上迭代状态同步到测试环境



1. 定义了快手内部使用的一个openapi接口

2. 当线上环境点击上线后就会触发，首先线上的数据库对应的状态机会变为“已上线”状态，之后这个线上系统就会构造一个请求body，出发openapi。

3. openapi其实就是对于域名和ip地址的映射。线上触发openapi后，本质其实是通过一个中间的服务器请求了测试系统的接口，之后测试系统就会更改状态即可。

   